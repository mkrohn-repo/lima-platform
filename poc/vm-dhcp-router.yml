#name: vm-dhcp-router

vmType: vz
arch: aarch64
cpus: 4
memory: "6GiB"
disk: "20GiB"

images:
  - location: "https://cloud-images.ubuntu.com/noble/current/noble-server-cloudimg-arm64.img"
    arch: "aarch64"
  # If there is a local copy  and you wish to use it
  # - location: "file:///Users/USERNAME/path/to/noble-server-cloudimg-arm64.img"

# Single bridged NIC , dhcp is from your router
networks:
  - lima: bridged
    macAddress: "02:00:00:00:05:01" # change per-VM as needed

ssh:
  loadDotSSHPubKeys: true

provision:
  - mode: system
    script: |
      #!/bin/bash
      set -eux
      apt-get update
      apt-get install -y qemu-guest-agent openssh-server curl ca-certificates net-tools
      apt-get full-upgrade -y
      systemctl enable --now ssh || systemctl enable --now sshd || true